<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE stax SYSTEM "../../shared/stax.dtd">
<!--
 ! CDDL HEADER START
 !
 ! The contents of this file are subject to the terms of the
 ! Common Development and Distribution License, Version 1.0 only
 ! (the "License").  You may not use this file except in compliance
 ! with the License.
 !
 ! You can obtain a copy of the license at
 ! trunk/opends/resource/legal-notices/OpenDS.LICENSE
 ! or https://OpenDS.dev.java.net/OpenDS.LICENSE.
 ! See the License for the specific language governing permissions
 ! and limitations under the License.
 !
 ! When distributing Covered Code, exclude this CDDL HEADER in each
 ! file and exclude the License file at
 ! trunk/opends/resource/legal-notices/OpenDS.LICENSE.  If applicable,
 ! add the following below this CDDL HEADER, with the fields enclosed
 ! by brackets "[]" replaced with your own identifying information:
 !      Portions Copyright [yyyy] [name of copyright owner]
 !
 ! CDDL HEADER END
 !
 !      Portions Copyright 2007 Sun Microsystems, Inc.
 ! -->

<stax>

  <defaultcall function="main_cluSearch"/>

  <function name="main_cluSearch">

    <sequence>

      <block name="'cluSearch'">
      
        <sequence>
  
          <script>
            if not CurrentTestPath.has_key('group'):
              CurrentTestPath['group']='clu'						  
            CurrentTestPath['suite']=STAXCurrentBlock
          </script>
      
          <call function="'testSuite_Preamble'"/>
                  
         <!--- Test Suite information
            #@TestSuiteName       Clu: Ldap Search: ldapsearch Tests
            #@TestSuitePurpose    Check the ldapsearch command with common options and input and output options
            #@TestSuiteID         Clu Ldap Search Tests
            #@TestSuiteGroup      cluSearch
            #@TestGroup           clu
            #@TestScript          cluSearch.xml
            #@TestHTMLLink        http://opends.dev.java.net/
          -->


          <import machine="STAF_LOCAL_HOSTNAME"
            file="'%s/testcases/clu/clu_setup.xml' % (TESTS_DIR)"/>
          <call function="'clu_setup'"> 
            { 'startDS' : True,
			  'loadBackend' : True } 
          </call>	  
         
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case #1 
            #@TestID              Test Case #1
            #@TestPurpose         Verify a substring ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch on cn=Elvis*
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 0
          -->
               
                 <testcase name="'Clu: Ldap Search: Test Case #1'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #1'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstanceHost'   : DIRECTORY_INSTANCE_HOST ,
                        'dsInstancePort'   : DIRECTORY_INSTANCE_PORT ,
                        'dsInstanceDn'     : DIRECTORY_INSTANCE_DN ,
                        'dsInstancePswd'   : DIRECTORY_INSTANCE_PSWD ,
                        'dsBaseDN'         : 'dc=com' ,
                        'dsFilter'         : 'cn=Elvis*' }                
                    </call>
    
                    <call function="'checktestRC'">
                      { 'returncode' : RC ,
                        'result'     : STAXResult }
                    </call>
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase> 
                							
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case #2 
            #@TestID              Test Case #2
            #@TestPurpose         Verify a parameter default doing an ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch on cn=Elvis*, without using hostname
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 0.
                                  In OpenDS if hostname is not given then a default
                                  of localhost is used.
                                  
          -->
               
                 <testcase name="'Clu: Ldap Search: Test Case #2'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #2'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstancePort'   : DIRECTORY_INSTANCE_PORT ,
                        'dsInstanceDn'     : DIRECTORY_INSTANCE_DN ,
                        'dsInstancePswd'   : DIRECTORY_INSTANCE_PSWD ,
                        'dsBaseDN'         : 'dc=com' ,
                        'dsFilter'         : 'cn=Elvis*' }                
                    </call>
    
                    <call function="'checktestRC'">
                      { 'returncode' : RC ,
                        'result'     : STAXResult}
                    </call>
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase> 
                           
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case #3 
            #@TestID              Test Case #3
            #@TestPurpose         Verify a parameter error doing an ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch on cn=Elvis*, and using an invalid hostname
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 91.
                                  
                                  
          -->
               
                 <testcase name="'Clu: Ldap Search: Test Case #3'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #3'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstanceHost'   : 'badhost' ,
                        'dsInstancePort'   : DIRECTORY_INSTANCE_PORT ,
                        'dsInstanceDn'     : DIRECTORY_INSTANCE_DN ,
                        'dsInstancePswd'   : DIRECTORY_INSTANCE_PSWD ,
                        'dsBaseDN'         : 'dc=com' ,
                        'dsFilter'         : 'cn=Elvis*' }                
                    </call>
    
                    <call function="'checktestRC'">
                      {'returncode' : RC ,
                       'result'     : STAXResult ,
                       'expected'   : 91 }
                    </call>
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase>
                 
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case #4 
            #@TestID              Test Case #4
            #@TestPurpose         Verify a parameter error doing an ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch on cn=Elvis*, with no port or basedn used.
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 89.
                                  
                                  
          -->
               
                 <testcase name="'Clu: Ldap Search: Test Case #4'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #4'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstanceHost'   : DIRECTORY_INSTANCE_HOST ,
                        'dsInstanceDn'     : DIRECTORY_INSTANCE_DN ,
                        'dsInstancePswd'   : DIRECTORY_INSTANCE_PSWD ,
                        'dsFilter'         : 'cn=Elvis*' }                
                    </call>
    
                    <call function="'checktestRC'">
                      {'returncode' : RC ,
                       'result'     : STAXResult ,
                       'expected'   : 89 }
                    </call>
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase>
                                  
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case #5 
            #@TestID              Test Case #5
            #@TestPurpose         Verify a parameter error doing an ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch on cn=Elvis*, with no port number and
                                  a -l with no timelimit value.
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 89.
                                  
                                  
          -->
               
                 <testcase name="'Clu: Ldap Search: Test Case #5'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #5'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstanceHost'   : DIRECTORY_INSTANCE_HOST ,
                        'dsInstancePort'   : ' ' ,
                        'dsInstanceDn'     : DIRECTORY_INSTANCE_DN ,
                        'dsInstancePswd'   : DIRECTORY_INSTANCE_PSWD ,
                        'dsTimeLimit'      : ' ',
                        'dsFilter'         : 'cn=Elvis*' }                
                    </call>
    
                    <call function="'checktestRC'">
                      {'returncode' : RC ,
                       'result'     : STAXResult ,
                       'expected'   : 89 }
                    </call>
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase>
                                                   
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case #6 
            #@TestID              Test Case #6
            #@TestPurpose         Verify a parameter error doing an ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch on cn=Elvis*, with an invalid bind dn.
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 32.
                                  
                                  
          -->
               
                 <testcase name="'Clu: Ldap Search: Test Case #6'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #6'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstanceHost'   : DIRECTORY_INSTANCE_HOST ,
                        'dsInstancePort'   : DIRECTORY_INSTANCE_PORT ,
                        'dsInstanceDn'     : 'cn=bad dn' ,
                        'dsInstancePswd'   : DIRECTORY_INSTANCE_PSWD ,
                        'dsBaseDN'         : 'dc=com' ,
                        'dsFilter'         : 'cn=Elvis*' }                
                    </call>
    
                    <call function="'checktestRC'">
                      {'returncode' : RC ,
                       'result'     : STAXResult ,
                       'expected'   : 32 }
                    </call>
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase>
                                                                    
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case #7 
            #@TestID              Test Case #7
            #@TestPurpose         Verify a parameter error doing an ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch on cn=Elvis*, without a password.
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 53.
                                  "unwilling to perform"
                                  
          -->
               
         <!--        <testcase name="'Clu: Ldap Search: Test Case #7'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #7'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstanceHost'   : DIRECTORY_INSTANCE_HOST ,
                        'dsInstancePort'   : DIRECTORY_INSTANCE_PORT ,
                        'dsInstanceDn'     : DIRECTORY_INSTANCE_DN ,
                        'dsBaseDN'         : 'dc=com' ,
                        'dsFilter'         : 'cn=Elvis*' }                
                    </call>
    
                    <call function="'checktestRC'">
                      {'returncode' : RC ,
                       'result'     : STAXResult ,
                       'expected'   : 48 }
                    </call>
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase> -->
                                                                                     
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case 8 
            #@TestID              Test Case #8
            #@TestPurpose         Verify a parameter error doing an ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch on cn=Elvis*, with an invalid password.
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 49.
                                  
                                  
          -->
               
                 <testcase name="'Clu: Ldap Search: Test Case #8'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #8'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstanceHost'   : DIRECTORY_INSTANCE_HOST ,
                        'dsInstancePort'   : DIRECTORY_INSTANCE_PORT ,
                        'dsInstanceDn'     : DIRECTORY_INSTANCE_DN ,
                        'dsInstancePswd'   : 'bad_password' ,
                        'dsBaseDN'         : 'dc=com' ,
                        'dsFilter'         : 'cn=Elvis*' }                
                    </call>
    
                    <call function="'checktestRC'">
                      {'returncode' : RC ,
                       'result'     : STAXResult ,
                       'expected'   : 49 }
                    </call>
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase>
          
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case 9 
            #@TestID              Test Case #9
            #@TestPurpose         Verify a parameter error doing an ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch on cn=Elvis*, with a scope and no value.
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 89.
                                  
                                  
          -->
               
                 <testcase name="'Clu: Ldap Search: Test Case #9'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #9'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstanceHost'   : DIRECTORY_INSTANCE_HOST ,
                        'dsInstancePort'   : DIRECTORY_INSTANCE_PORT ,
                        'dsInstanceDn'     : DIRECTORY_INSTANCE_DN ,
                        'dsInstancePswd'   : DIRECTORY_INSTANCE_PSWD ,
                        'dsScope'          : ' ',
                        'dsBaseDN'         : 'dc=com' ,
                        'dsFilter'         : 'cn=Elvis*' }                
                    </call>
    
                    <call function="'checktestRC'">
                      {'returncode' : RC ,
                       'result'     : STAXResult ,
                       'expected'   : 89 }
                    </call>
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase>
                           
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case 10 
            #@TestID              Test Case #10
            #@TestPurpose         Verify a parameter error doing an ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch on cn=Elvis*, with an invalid scope.
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 89.
                                  
                                  
          -->
               
                 <testcase name="'Clu: Ldap Search: Test Case #10'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #10'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstanceHost'   : DIRECTORY_INSTANCE_HOST ,
                        'dsInstancePort'   : DIRECTORY_INSTANCE_PORT ,
                        'dsInstanceDn'     : DIRECTORY_INSTANCE_DN ,
                        'dsInstancePswd'   : DIRECTORY_INSTANCE_PSWD ,
                        'dsScope'          : 'bad ',
                        'dsBaseDN'         : 'dc=com' ,
                        'dsFilter'         : 'cn=Elvis*' }                
                    </call>
    
                    <call function="'checktestRC'">
                      {'returncode' : RC ,
                       'result'     : STAXResult ,
                       'expected'   : 89 }
                    </call>
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase>
                                            
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case 11 
            #@TestID              Test Case #11
            #@TestPurpose         Verify a parameter error doing an ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch on cn=Elvis*, with an empty basedn.
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 89.
                                  
                                  
          -->
               
                 <testcase name="'Clu: Ldap Search: Test Case #11'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #11'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstanceHost'   : DIRECTORY_INSTANCE_HOST ,
                        'dsInstancePort'   : DIRECTORY_INSTANCE_PORT ,
                        'dsInstanceDn'     : DIRECTORY_INSTANCE_DN ,
                        'dsInstancePswd'   : DIRECTORY_INSTANCE_PSWD ,
                        'dsBaseDN'         : 'cn=Elvis*' }            
                    </call>
    
                    <call function="'checktestRC'">
                      {'returncode' : RC ,
                       'result'     : STAXResult ,
                       'expected'   : 89 }
                    </call>
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase>
                                                             
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case 12 
            #@TestID              Test Case #12
            #@TestPurpose         Verify a parameter error doing an ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch on cn=Elvis*, with an invalid basedn.
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 32.
                                 
                                  
          -->
               
                 <testcase name="'Clu: Ldap Search: Test Case #12'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #12'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstanceHost'   : DIRECTORY_INSTANCE_HOST ,
                        'dsInstancePort'   : DIRECTORY_INSTANCE_PORT ,
                        'dsInstanceDn'     : DIRECTORY_INSTANCE_DN ,
                        'dsInstancePswd'   : DIRECTORY_INSTANCE_PSWD ,
                        'dsBaseDN'         : 'o=bad.dn' ,
                        'dsFilter'         : 'cn=Elvis*' }                
                    </call>
    
                    <call function="'checktestRC'">
                      {'returncode' : RC ,
                       'result'     : STAXResult ,
                       'expected'   : 32 }
                    </call>
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase>
                                                                              
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case 13 
            #@TestID              Test Case #13
            #@TestPurpose         Verify a parameter error doing an ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch without a filter.
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 89.
                                  
                                  
          -->
               
                 <testcase name="'Clu: Ldap Search: Test Case #13'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #13'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstanceHost'   : DIRECTORY_INSTANCE_HOST ,
                        'dsInstancePort'   : DIRECTORY_INSTANCE_PORT ,
                        'dsInstanceDn'     : DIRECTORY_INSTANCE_DN ,
                        'dsInstancePswd'   : DIRECTORY_INSTANCE_PSWD ,
                        'dsBaseDN'         : 'dc=com' , }              
                    </call>
    
                    <call function="'checktestRC'">
                      {'returncode' : RC ,
                       'result'     : STAXResult ,
                       'expected'   : 89 }
                    </call>
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase>
                                                                                               
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case 14 
            #@TestID              Test Case #14
            #@TestPurpose         Verify a parameter doing an ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch with dry run option.
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 0.
                                                                    
          -->
               
                 <testcase name="'Clu: Ldap Search: Test Case #14'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #14'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstanceHost'   : DIRECTORY_INSTANCE_HOST ,
                        'dsInstancePort'   : DIRECTORY_INSTANCE_PORT ,
                        'dsInstanceDn'     : DIRECTORY_INSTANCE_DN ,
                        'dsInstancePswd'   : DIRECTORY_INSTANCE_PSWD ,
                        'dsDryRun'         : 'True' ,
                        'dsBaseDN'         : 'dc=com' , 
                        'dsFilter'         : 'cn=Elvis*' }
                    </call>
    
                    <call function="'checktestRC'">
                      {'returncode' : RC ,
                       'result'     : STAXResult }
                    </call>
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase>
                 
                                                                                                                
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case 15 
            #@TestID              Test Case #15
            #@TestPurpose         Verify a parameter doing an ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch with the verbose option.
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 0.
                                                                    
          -->
               
                 <testcase name="'Clu: Ldap Search: Test Case #15'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #15'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstanceHost'   : DIRECTORY_INSTANCE_HOST ,
                        'dsInstancePort'   : DIRECTORY_INSTANCE_PORT ,
                        'dsInstanceDn'     : DIRECTORY_INSTANCE_DN ,
                        'dsInstancePswd'   : DIRECTORY_INSTANCE_PSWD ,
                        'dsVerbose'        : 'True' ,
                        'dsBaseDN'         : 'dc=com' , 
                        'dsFilter'         : 'cn=Elvis*' }
                    </call>
    
                    <call function="'checktestRC'">
                      {'returncode' : RC ,
                       'result'     : STAXResult }
                    </call>
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase>
                                                                                                                                 
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case 17 
            #@TestID              Test Case #17
            #@TestPurpose         Verify a parameter doing an ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch with timelimit of 20 seconds option.
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 0.
                                                                    
          -->
               
                 <testcase name="'Clu: Ldap Search: Test Case #17'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #17'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstanceHost'   : DIRECTORY_INSTANCE_HOST ,
                        'dsInstancePort'   : DIRECTORY_INSTANCE_PORT ,
                        'dsInstanceDn'     : DIRECTORY_INSTANCE_DN ,
                        'dsInstancePswd'   : DIRECTORY_INSTANCE_PSWD ,
                        'dsTimeLimit'      : '20' ,
                        'dsBaseDN'         : 'dc=com' , 
                        'dsFilter'         : 'cn=Elvis*' }
                    </call>
    
                    <call function="'checktestRC'">
                      {'returncode' : RC ,
                       'result'     : STAXResult }
                    </call>
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase>
                                                                                                                                                  
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case 18 
            #@TestID              Test Case #18
            #@TestPurpose         Verify a parameter error doing an ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch with timelimit of 1 second.
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 85.
                                                                    
          -->
               
                 <testcase name="'Clu: Ldap Search: Test Case #18'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #18'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstanceHost'   : DIRECTORY_INSTANCE_HOST ,
                        'dsInstancePort'   : DIRECTORY_INSTANCE_PORT ,
                        'dsInstanceDn'     : DIRECTORY_INSTANCE_DN ,
                        'dsInstancePswd'   : DIRECTORY_INSTANCE_PSWD ,
                        'dsTimeLimit'      : '1' ,
                        'dsBaseDN'         : 'dc=example,dc=com' , 
                        'dsFilter'         : 'objectclass=*' }
                    </call>
    
                    <call function="'checktestRC'">
                      {'returncode' : RC ,
                       'result'     : STAXResult,
                       'expected'   : 85 }
                    </call>
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase>
                 
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case 19 
            #@TestID              Test Case #19
            #@TestPurpose         Verify a parameter doing an ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch with sizelimit option.
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 0.
                                                                    
          -->
               
                 <testcase name="'Clu: Ldap Search: Test Case #19'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #19'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstanceHost'   : DIRECTORY_INSTANCE_HOST ,
                        'dsInstancePort'   : DIRECTORY_INSTANCE_PORT ,
                        'dsInstanceDn'     : DIRECTORY_INSTANCE_DN ,
                        'dsInstancePswd'   : DIRECTORY_INSTANCE_PSWD ,
                        'dsSizeLimit'      : '100' ,
                        'dsBaseDN'         : 'dc=com' , 
                        'dsFilter'         : 'cn=Elvis*' }
                    </call>
    
                    <call function="'checktestRC'">
                      {'returncode' : RC ,
                       'result'     : STAXResult }
                    </call>
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase>
                                  
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case 20 
            #@TestID              Test Case #20
            #@TestPurpose         Verify a parameter error doing an ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch with the sizelimit option.
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 4.
                                                                    
          -->
               
                 <testcase name="'Clu: Ldap Search: Test Case #20'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #20'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstanceHost'   : DIRECTORY_INSTANCE_HOST ,
                        'dsInstancePort'   : DIRECTORY_INSTANCE_PORT ,
                        'dsInstanceDn'     : DIRECTORY_INSTANCE_DN ,
                        'dsInstancePswd'   : DIRECTORY_INSTANCE_PSWD ,
                        'dsSizeLimit'      : '1' ,
                        'dsBaseDN'         : 'cn=config' , 
                        'dsFilter'         : 'objectclass=*' }
                    </call>
    
                    <call function="'checktestRC'">
                      {'returncode' : RC ,
                       'result'     : STAXResult,
                       'expected'   : 4 }
                    </call>
                    
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase>
                                                   
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case 21 
            #@TestID              Test Case #21
            #@TestPurpose         Verify a parameter doing an ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch with the help option.
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 0.
                                                                    
          -->
               
                 <testcase name="'Clu: Ldap Search: Test Case #21'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #21'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstanceHost'   : DIRECTORY_INSTANCE_HOST ,
                        'dsInstancePort'   : DIRECTORY_INSTANCE_PORT ,
                        'dsInstanceDn'     : DIRECTORY_INSTANCE_DN ,
                        'dsInstancePswd'   : DIRECTORY_INSTANCE_PSWD ,
                        'dsHelp'           : 'True' ,
                        'dsBaseDN'         : 'dc=com' , 
                        'dsFilter'         : 'cn=Elvis*' }
                    </call>
    
                    <call function="'checktestRC'">
                      {'returncode' : RC ,
                       'result'     : STAXResult }
                    </call>
                    
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase>
                                                                    
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case 24 
            #@TestID              Test Case #24
            #@TestPurpose         Verify a parameter doing an ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch with the don't wrap option.
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 0.
                                                                    
          -->
               
                 <testcase name="'Clu: Ldap Search: Test Case #24'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #24'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstanceHost'   : DIRECTORY_INSTANCE_HOST ,
                        'dsInstancePort'   : DIRECTORY_INSTANCE_PORT ,
                        'dsInstanceDn'     : DIRECTORY_INSTANCE_DN ,
                        'dsInstancePswd'   : DIRECTORY_INSTANCE_PSWD ,
                        'dsDontWrap'       : 'True' ,
                        'dsBaseDN'         : 'dc=com' , 
                        'dsFilter'         : 'cn=Elvis*' }
                    </call>
    
                    <call function="'checktestRC'">
                      {'returncode' : RC ,
                       'result'     : STAXResult }
                    </call>
                    
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase>
                                                                                     
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case 31 
            #@TestID              Test Case #31
            #@TestPurpose         Verify a parameter doing an ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch with the a sort order of uid.
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 0.
                                                                    
          -->
               
                 <testcase name="'Clu: Ldap Search: Test Case #31'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #31'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstanceHost'   : DIRECTORY_INSTANCE_HOST ,
                        'dsInstancePort'   : DIRECTORY_INSTANCE_PORT ,
                        'dsInstanceDn'     : DIRECTORY_INSTANCE_DN ,
                        'dsInstancePswd'   : DIRECTORY_INSTANCE_PSWD ,
                        'dsSortOrder'      : 'uid' ,
                        'dsBaseDN'         : 'dc=com' , 
                        'dsFilter'         : 'cn=Elvis*' }
                    </call>
    
                    <call function="'checktestRC'">
                      {'returncode' : RC ,
                       'result'     : STAXResult }
                    </call>
                    
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase>
                                                                                                      
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case 32 
            #@TestID              Test Case #32
            #@TestPurpose         Verify a parameter doing an ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch with the a sort order of bad.
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 2, protocol error.
                                                                    
          -->
               
                 <testcase name="'Clu: Ldap Search: Test Case #32'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #32'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstanceHost'   : DIRECTORY_INSTANCE_HOST ,
                        'dsInstancePort'   : DIRECTORY_INSTANCE_PORT ,
                        'dsInstanceDn'     : DIRECTORY_INSTANCE_DN ,
                        'dsInstancePswd'   : DIRECTORY_INSTANCE_PSWD ,
                        'dsSortOrder'      : 'bad' ,
                        'dsBaseDN'         : 'dc=com' , 
                        'dsFilter'         : 'cn=Elvis*' }
                    </call>
    
                    <call function="'checktestRC'">
                      {'returncode' : RC ,
                       'result'     : STAXResult,
                       'expected'   : 2 }
                    </call>
                    
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase>
                                                                                                                       
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case 33 
            #@TestID              Test Case #33
            #@TestPurpose         Verify a parameter doing an ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch with the a dereference policy of always.
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 0.
                                                                    
          -->
               
                 <testcase name="'Clu: Ldap Search: Test Case #33'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #33'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstanceHost'      : DIRECTORY_INSTANCE_HOST ,
                        'dsInstancePort'      : DIRECTORY_INSTANCE_PORT ,
                        'dsInstanceDn'        : DIRECTORY_INSTANCE_DN ,
                        'dsInstancePswd'      : DIRECTORY_INSTANCE_PSWD ,
                        'dsDereferencePolicy' : 'always' ,
                        'dsBaseDN'            : 'dc=com' , 
                        'dsFilter'            : 'cn=Elvis*' }
                    </call>
    
                    <call function="'checktestRC'">
                      {'returncode' : RC ,
                       'result'     : STAXResult }
                    </call>
                    
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase>
                                                                                                                       
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case 34 
            #@TestID              Test Case #34
            #@TestPurpose         Verify a parameter doing an ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch with the a dereference policy of bad.
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 1, operations error.
                                                                    
          -->
               
                 <testcase name="'Clu: Ldap Search: Test Case #34'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #34'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstanceHost'      : DIRECTORY_INSTANCE_HOST ,
                        'dsInstancePort'      : DIRECTORY_INSTANCE_PORT ,
                        'dsInstanceDn'        : DIRECTORY_INSTANCE_DN ,
                        'dsInstancePswd'      : DIRECTORY_INSTANCE_PSWD ,
                        'dsDereferencePolicy' : 'bad' ,
                        'dsBaseDN'            : 'dc=com' , 
                        'dsFilter'            : 'cn=Elvis*' }
                    </call>
    
                    <call function="'checktestRC'">
                      {'returncode' : RC ,
                       'result'     : STAXResult,
                       'expected'   : 89 }
                    </call>
                    
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase>
                                                                                                                                        
          <!--- Test Case information
            #@TestMarker          Clu Ldap Search Tests
            #@TestName            Clu: Ldap Search: Test Case 35 
            #@TestID              Test Case #35
            #@TestPurpose         Verify a parameter doing an ldapsearch.
            #@TestPreamble
            #@TestSteps           Do an ldapsearch with the a bad base dn.
            #@TestPostamble
            #@TestResult          Success if ldapSearchWithScript returns 32.
                                                                    
          -->
               
                 <testcase name="'Clu: Ldap Search: Test Case #35'">
        
                  <sequence>
          
                    <call function="'testCase_Preamble'"/>
                    <message>
                      'Clu: Ldap Search: Test Case #35'
                    </message>
                    <call function="'ldapSearchWithScript'">
                      { 'dsInstanceHost'      : DIRECTORY_INSTANCE_HOST ,
                        'dsInstancePort'      : DIRECTORY_INSTANCE_PORT ,
                        'dsInstanceDn'        : DIRECTORY_INSTANCE_DN ,
                        'dsInstancePswd'      : DIRECTORY_INSTANCE_PSWD ,
                        'dsBaseDN'            : 'cn=bad,cn=config' , 
                        'dsFilter'            : 'objectclass=*' }
                    </call>
    
                    <call function="'checktestRC'">
                      {'returncode' : RC ,
                       'result'     : STAXResult,
                       'expected'   : 32 }
                    </call>
                    
                    <call function="'testCase_Postamble'"/>
          
                  </sequence>
          
                 </testcase>
                 
                 
          <import machine="STAF_LOCAL_HOSTNAME"
            file="'%s/testcases/clu/clu_cleanup.xml' % (TESTS_DIR)"/>
          <call function="'clu_cleanup'"> { 'stopDS' : True } </call>

												    
        </sequence>
    
      </block>
    
    </sequence>

  </function>

</stax>

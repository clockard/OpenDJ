<?xml version="1.0" encoding="utf-8"?>
<!--
! CDDL HEADER START
!
! The contents of this file are subject to the terms of the
! Common Development and Distribution License, Version 1.0 only
! (the "License").  You may not use this file except in compliance
! with the License.
!
! You can obtain a copy of the license at
! trunk/opends/resource/legal-notices/OpenDS.LICENSE
! or https://OpenDS.dev.java.net/OpenDS.LICENSE.
! See the License for the specific language governing permissions
! and limitations under the License.
!
! When distributing Covered Code, include this CDDL HEADER in each
! file and include the License file at
! trunk/opends/resource/legal-notices/OpenDS.LICENSE.  If applicable,
! add the following below this CDDL HEADER, with the fields enclosed
! by brackets "[]" replaced with your own identifying information:
!      Portions Copyright [yyyy] [name of copyright owner]
!
! CDDL HEADER END
!
!
!      Portions Copyright 2007 Sun Microsystems, Inc.
! -->

<adm:managed-object name="password-policy-import-plugin"
  plural-name="password-policy-import-plugins"
  package="org.opends.server.admin.std" extends="plugin"
  xmlns:adm="http://www.opends.org/admin"
  xmlns:ldap="http://www.opends.org/admin-ldap">

  <adm:synopsis>
    The
    <adm:user-friendly-name />
    is used to ensure that clear-text passwords contained in LDIF entries are
    properly encoded before they are stored in the appropriate Directory Server
    backend.
  </adm:synopsis>

  <adm:profile name="ldap">
    <ldap:object-class>
      <ldap:oid>1.3.6.1.4.1.26027.1.2.115</ldap:oid>
      <ldap:name>ds-cfg-password-policy-import-plugin</ldap:name>
      <ldap:superior>ds-cfg-plugin</ldap:superior>
    </ldap:object-class>
  </adm:profile>

  <adm:property-override name="plugin-class">
    <adm:default-behavior>
      <adm:defined>
        <adm:value>
          org.opends.server.plugins.PasswordPolicyImportPlugin
        </adm:value>
      </adm:defined>
    </adm:default-behavior>
  </adm:property-override>

  <adm:property-override name="plugin-type">
    <adm:default-behavior>
      <adm:defined>
        <adm:value>ldifimport</adm:value>
      </adm:defined>
    </adm:default-behavior>
  </adm:property-override>

  <adm:property name="default-user-password-storage-scheme-dn" mandatory="false"
       multi-valued="true">
    <adm:synopsis>
      Specifies the DNs of the configuration entries for the password storage
      schemes that will be used for encoding passwords contained in attributes
      with the user password syntax for entries that do not include the
      ds-pwp-password-policy-dn attribute to specify which password policy
      should be used to govern them.
    </adm:synopsis>
    <adm:default-behavior>
      <adm:alias>
        <adm:synopsis>
          If the default password policy uses the attribute with the user
          password syntax, then the server will use the default password storage
          schemes for that password policy.  Otherwise, it will encode user
          password values using the "SSHA" scheme.
        </adm:synopsis>
      </adm:alias>
    </adm:default-behavior>
    <adm:syntax>
      <adm:dn>
        <adm:base>cn=password storage schemes,cn=config</adm:base>
      </adm:dn>
    </adm:syntax>
    <adm:profile name="ldap">
      <ldap:attribute>
        <ldap:oid>1.3.6.1.4.1.26027.1.1.429</ldap:oid>
        <ldap:name>ds-cfg-default-user-password-storage-scheme</ldap:name>
      </ldap:attribute>
    </adm:profile>
  </adm:property>

  <adm:property name="default-auth-password-storage-scheme-dn" mandatory="false"
  multi-valued="true">
    <adm:synopsis>
      Specifies the DNs of the configuration entries for the password storage
      schemes that will be used for encoding passwords contained in attributes
      with the auth password syntax for entries that do not include the
      ds-pwp-password-policy-dn attribute to specify which password policy
      should be used to govern them.
    </adm:synopsis>
    <adm:default-behavior>
      <adm:alias>
        <adm:synopsis>
          If the default password policy uses an attribute with the auth
          password syntax, then the server will use the default password storage
          schemes for that password policy.  Otherwise, it will encode auth
          password values using the "SHA1" scheme.
        </adm:synopsis>
      </adm:alias>
    </adm:default-behavior>
    <adm:syntax>
      <adm:dn>
        <adm:base>cn=password storage schemes,cn=config</adm:base>
      </adm:dn>
    </adm:syntax>
    <adm:profile name="ldap">
      <ldap:attribute>
        <ldap:oid>1.3.6.1.4.1.26027.1.1.430</ldap:oid>
        <ldap:name>ds-cfg-default-auth-password-storage-scheme-dn</ldap:name>
      </ldap:attribute>
    </adm:profile>
  </adm:property>

</adm:managed-object>


<?xml version="1.0" encoding="UTF-8"?>
<!--
  ! CDDL HEADER START
  !
  ! The contents of this file are subject to the terms of the
  ! Common Development and Distribution License, Version 1.0 only
  ! (the "License").  You may not use this file except in compliance
  ! with the License.
  !
  ! You can obtain a copy of the license at
  ! trunk/opends/resource/legal-notices/OpenDS.LICENSE
  ! or https://OpenDS.dev.java.net/OpenDS.LICENSE.
  ! See the License for the specific language governing permissions
  ! and limitations under the License.
  !
  ! When distributing Covered Code, include this CDDL HEADER in each
  ! file and include the License file at
  ! trunk/opends/resource/legal-notices/OpenDS.LICENSE.  If applicable,
  ! add the following below this CDDL HEADER, with the fields enclosed
  ! by brackets "[]" replaced with your own identifying information:
  !      Portions Copyright [yyyy] [name of copyright owner]
  !
  ! CDDL HEADER END
  !
  !
  !      Portions Copyright 2007 Sun Microsystems, Inc.
  ! -->
<adm:managed-object name="referential-integrity-plugin"
  plural-name="referential-integrity-plugins"
  package="org.opends.server.admin.std" extends="plugin"
  xmlns:adm="http://www.opends.org/admin"
  xmlns:ldap="http://www.opends.org/admin-ldap">
  <adm:synopsis>
    The
    <adm:user-friendly-name />
    is used to maintain referential integrity for DN valued attributes.
  </adm:synopsis>
  <adm:description>
    The values of these attributes may reference entries that have been
    deleted by a delete operation or renamed by a modify DN operation.
    The referential integrity plugin will remove stale references to
    deleted entries or update references to renamed entries. The
    referential integrity plugin allows the scope of this referential
    check to be limited to a set of base DNs if desired. It also can be
    configured to perform the referential checking in the background
    mode specified intervals.
  </adm:description>
  <adm:profile name="ldap">
    <ldap:object-class>
      <ldap:name>ds-cfg-referential-integrity-plugin</ldap:name>
      <ldap:superior>ds-cfg-plugin</ldap:superior>
    </ldap:object-class>
  </adm:profile>
  <adm:property-override name="java-class" advanced="true">
    <adm:default-behavior>
      <adm:defined>
        <adm:value>
          org.opends.server.plugins.ReferentialIntegrityPlugin
        </adm:value>
      </adm:defined>
    </adm:default-behavior>
  </adm:property-override>
  <adm:property-override name="plugin-type" advanced="true">
    <adm:default-behavior>
      <adm:defined>
        <adm:value>postoperationdelete</adm:value>
        <adm:value>postoperationmodifydn</adm:value>
        <adm:value>subordinatemodifydn</adm:value>
      </adm:defined>
    </adm:default-behavior>
  </adm:property-override>
  <adm:property name="attribute-type" mandatory="true"
    multi-valued="true">
    <adm:synopsis>
      Specifies the attribute types for which referential integrity
      should be maintained.
    </adm:synopsis>
    <adm:description>
      There must be at least one attribute type specified and the syntax
      of them must either be distinguished name
      (1.3.6.1.4.1.1466.115.121.1.12) or name and optional uid
      (1.3.6.1.4.1.1466.115.121.1.34).
    </adm:description>
    <adm:syntax>
      <adm:attribute-type />
    </adm:syntax>
    <adm:profile name="ldap">
      <ldap:attribute>
        <ldap:name>ds-cfg-attribute-type</ldap:name>
      </ldap:attribute>
    </adm:profile>
  </adm:property>
  <adm:property name="base-dn" multi-valued="true">
    <adm:synopsis>
      Specifies the scope within which referential integrity will be
      maintained.
    </adm:synopsis>
    <adm:default-behavior>
      <adm:alias>
        <adm:synopsis>
          Referential integrity will be maintained in all public naming
          contexts.
        </adm:synopsis>
      </adm:alias>
    </adm:default-behavior>
    <adm:syntax>
      <adm:dn />
    </adm:syntax>
    <adm:profile name="ldap">
      <ldap:attribute>
        <ldap:name>ds-cfg-base-dn</ldap:name>
      </ldap:attribute>
    </adm:profile>
  </adm:property>
  <adm:property name="log-file">
    <adm:synopsis>
      Specifies the log file location where the update records will be
      written when the plugin is in background mode processing.
    </adm:synopsis>
    <adm:description>
      The default location is in the logs directory of the server
      instance, using the file name "referint".
    </adm:description>
    <adm:default-behavior>
      <adm:defined>
        <adm:value>logs/referint</adm:value>
      </adm:defined>
    </adm:default-behavior>
    <adm:syntax>
      <adm:string />
    </adm:syntax>
    <adm:profile name="ldap">
      <ldap:attribute>
        <ldap:name>ds-cfg-log-file</ldap:name>
      </ldap:attribute>
    </adm:profile>
  </adm:property>
  <adm:property name="update-interval">
    <adm:synopsis>
      Specifies the interval, in seconds, when referential integrity
      updates will be made.
    </adm:synopsis>
    <adm:description>
      If this value is 0, then the updates are made synchronously in the
      foreground.
    </adm:description>
    <adm:default-behavior>
      <adm:defined>
        <adm:value>0 seconds</adm:value>
      </adm:defined>
    </adm:default-behavior>
    <adm:syntax>
      <adm:duration base-unit="s" allow-unlimited="false" />
    </adm:syntax>
    <adm:profile name="ldap">
      <ldap:attribute>
        <ldap:name>ds-cfg-update-interval</ldap:name>
      </ldap:attribute>
    </adm:profile>
  </adm:property>
</adm:managed-object>
